#!/bin/bash
#
# S2I run script for the 'rails' image.
# The run script executes the server that runs your application.
#
# For more information see the documentation:
#	https://github.com/openshift/source-to-image/blob/master/docs/builder_image.md
#

export RAILS_ENV=production
export RAILS_LOG_TO_STDOUT=true

echo "---> Migrating database ..."
bundle exec rake db:migrate 2>/dev/null || bundle exec rake db:setup

echo "---> Serving application with Puma ..."
bundle exec puma -C config/puma.rb
